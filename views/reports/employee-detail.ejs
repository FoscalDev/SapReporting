<!-- Breadcrumb -->
<nav aria-label="breadcrumb">
    <ol class="breadcrumb">
        <li class="breadcrumb-item"><a href="/">Inicio</a></li>
        <li class="breadcrumb-item active">Empleado <%= employee.id %></li>
    </ol>
</nav>

<!-- Header del empleado -->
<div class="row mb-4">
    <div class="col-12">
        <div class="card">
            <div class="card-body">
                <div class="row align-items-center">
                    <div class="col-md-8">
                        <h1 class="mb-2">
                            <i class="fas fa-user me-2"></i>
                            <%= employee.name || 'Sin nombre' %>
                        </h1>
                        <p class="text-muted mb-1">
                            <strong>ID Empleado:</strong> <%= employee.id %>
                        </p>
                        <p class="text-muted mb-0">
                            <strong>Cargo:</strong> <%= employee.jobDescription %>
                        </p>
                    </div>
                    <div class="col-md-4 text-end">
                        <div class="badge bg-primary fs-6 mb-2">
                            <i class="fas fa-building me-1"></i>
                            <%= employee.organizationalUnit.description %>
                        </div>
                        <div class="badge bg-success fs-6">
                            <i class="fas fa-money-bill-wave me-1"></i>
                            <%= new Intl.NumberFormat('es-CO', {
                                style: 'currency',
                                currency: 'COP',
                                minimumFractionDigits: 0
                            }).format(employee.baseSalary) %>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Información detallada -->
<div class="row">
    <!-- Información Laboral -->
    <div class="col-md-6 mb-4">
        <div class="card h-100">
            <div class="card-header">
                <h5 class="mb-0"><i class="fas fa-briefcase me-2"></i>Información Laboral</h5>
            </div>
            <div class="card-body">
                <div class="row mb-3">
                    <div class="col-sm-4"><strong>Código Cargo:</strong></div>
                    <div class="col-sm-8"><%= employee.jobCode %></div>
                </div>
                <div class="row mb-3">
                    <div class="col-sm-4"><strong>Descripción Cargo:</strong></div>
                    <div class="col-sm-8"><%= employee.jobDescription %></div>
                </div>
                <div class="row mb-3">
                    <div class="col-sm-4"><strong>Grupo Empleado:</strong></div>
                    <div class="col-sm-8"><%= employee.employeeGroup %></div>
                </div>
                <div class="row mb-3">
                    <div class="col-sm-4"><strong>Tipo Salario:</strong></div>
                    <div class="col-sm-8"><%= employee.salaryType %></div>
                </div>
                <div class="row mb-3">
                    <div class="col-sm-4"><strong>Horas Contrato:</strong></div>
                    <div class="col-sm-8"><%= employee.contractedHours %> horas</div>
                </div>
                <div class="row mb-3">
                    <div class="col-sm-4"><strong>Salario Base:</strong></div>
                    <div class="col-sm-8">
                        <span class="fs-5 text-success">
                            <%= new Intl.NumberFormat('es-CO', {
                                style: 'currency',
                                currency: 'COP',
                                minimumFractionDigits: 0
                            }).format(employee.baseSalary) %>
                        </span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Información Organizacional -->
    <div class="col-md-6 mb-4">
        <div class="card h-100">
            <div class="card-header">
                <h5 class="mb-0"><i class="fas fa-sitemap me-2"></i>Información Organizacional</h5>
            </div>
            <div class="card-body">
                <div class="row mb-3">
                    <div class="col-sm-4"><strong>Unidad Org.:</strong></div>
                    <div class="col-sm-8">
                        <div><%= employee.organizationalUnit.description %></div>
                        <small class="text-muted">Código: <%= employee.organizationalUnit.code %></small>
                    </div>
                </div>
                <div class="row mb-3">
                    <div class="col-sm-4"><strong>Área Personal:</strong></div>
                    <div class="col-sm-8">
                        <div><%= employee.personnelArea.description %></div>
                        <small class="text-muted">Código: <%= employee.personnelArea.code %></small>
                    </div>
                </div>
                <div class="row mb-3">
                    <div class="col-sm-4"><strong>Centro Costo:</strong></div>
                    <div class="col-sm-8">
                        <div><%= employee.costCenter.description %></div>
                        <small class="text-muted">Código: <%= employee.costCenter.code %></small>
                    </div>
                </div>
                <div class="row mb-3">
                    <div class="col-sm-4"><strong>Código Empresa:</strong></div>
                    <div class="col-sm-8"><%= employee.companyCode %></div>
                </div>
            </div>
        </div>
    </div>

    <!-- Información Contractual -->
    <div class="col-md-6 mb-4">
        <div class="card h-100">
            <div class="card-header">
                <h5 class="mb-0"><i class="fas fa-file-contract me-2"></i>Información Contractual</h5>
            </div>
            <div class="card-body">
                <div class="row mb-3">
                    <div class="col-sm-4"><strong>Fecha Inicio:</strong></div>
                    <div class="col-sm-8">
                        <% if (employee.contractStartDate) { %>
                            <%= new Date(employee.contractStartDate).toLocaleDateString('es-CO') %>
                        <% } else { %>
                            <span class="text-muted">Sin fecha</span>
                        <% } %>
                    </div>
                </div>
                <div class="row mb-3">
                    <div class="col-sm-4"><strong>Fecha Fin:</strong></div>
                    <div class="col-sm-8">
                        <% if (employee.contractEndDate) { %>
                            <%= new Date(employee.contractEndDate).toLocaleDateString('es-CO') %>
                        <% } else { %>
                            <span class="text-success">Indefinido</span>
                        <% } %>
                    </div>
                </div>
                <div class="row mb-3">
                    <div class="col-sm-4"><strong>Promedio 3 meses:</strong></div>
                    <div class="col-sm-8">
                        <%= new Intl.NumberFormat('es-CO', {
                            style: 'currency',
                            currency: 'COP',
                            minimumFractionDigits: 0
                        }).format(employee.average3Months) %>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Bonificaciones -->
    <div class="col-md-6 mb-4">
        <div class="card h-100">
            <div class="card-header">
                <h5 class="mb-0"><i class="fas fa-gift me-2"></i>Bonificaciones</h5>
            </div>
            <div class="card-body">
                <div class="row mb-3">
                    <div class="col-sm-6"><strong>Reemplazo:</strong></div>
                    <div class="col-sm-6">
                        <%= new Intl.NumberFormat('es-CO', {
                            style: 'currency',
                            currency: 'COP',
                            minimumFractionDigits: 0
                        }).format(employee.bonuses.replacement) %>
                    </div>
                </div>
                <div class="row mb-3">
                    <div class="col-sm-6"><strong>Otras Bonificaciones:</strong></div>
                    <div class="col-sm-6">
                        <%= new Intl.NumberFormat('es-CO', {
                            style: 'currency',
                            currency: 'COP',
                            minimumFractionDigits: 0
                        }).format(employee.bonuses.others) %>
                    </div>
                </div>
                <div class="row mb-3">
                    <div class="col-sm-6"><strong>Especialidad:</strong></div>
                    <div class="col-sm-6">
                        <%= new Intl.NumberFormat('es-CO', {
                            style: 'currency',
                            currency: 'COP',
                            minimumFractionDigits: 0
                        }).format(employee.bonuses.specialty) %>
                    </div>
                </div>
                <div class="row mb-3">
                    <div class="col-sm-6"><strong>Auxilio Transporte:</strong></div>
                    <div class="col-sm-6">
                        <%= new Intl.NumberFormat('es-CO', {
                            style: 'currency',
                            currency: 'COP',
                            minimumFractionDigits: 0
                        }).format(employee.bonuses.transportation) %>
                    </div>
                </div>
                <hr>
                <div class="row">
                    <div class="col-sm-6"><strong>Total Bonificaciones:</strong></div>
                    <div class="col-sm-6">
                        <span class="fs-6 text-primary">
                            <%= new Intl.NumberFormat('es-CO', {
                                style: 'currency',
                                currency: 'COP',
                                minimumFractionDigits: 0
                            }).format(employee.bonuses.replacement + employee.bonuses.others + employee.bonuses.specialty + employee.bonuses.transportation) %>
                        </span>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Acciones -->
<div class="row">
    <div class="col-12">
        <div class="card">
            <div class="card-body text-center">
                <a href="/" class="btn btn-secondary me-2">
                    <i class="fas fa-arrow-left me-1"></i>Volver al Listado
                </a>
                <button class="btn btn-primary me-2" onclick="window.print()">
                    <i class="fas fa-print me-1"></i>Imprimir
                </button>
                <button class="btn btn-success" onclick="exportEmployeeData()">
                    <i class="fas fa-download me-1"></i>Exportar Datos
                </button>
            </div>
        </div>
    </div>
</div>

<script>
    function exportEmployeeData() {
        const employeeData = {
            id: '<%= employee.id %>',
            name: '<%= employee.name %>',
            jobCode: '<%= employee.jobCode %>',
            jobDescription: '<%= employee.jobDescription %>',
            baseSalary: <%= employee.baseSalary %>,
            contractedHours: <%= employee.contractedHours %>,
            organizationalUnit: '<%= employee.organizationalUnit.description %>',
            personnelArea: '<%= employee.personnelArea.description %>',
            costCenter: '<%= employee.costCenter.description %>',
            contractStartDate: '<%= employee.contractStartDate ? new Date(employee.contractStartDate).toLocaleDateString("es-CO") : "Sin fecha" %>',
            contractEndDate: '<%= employee.contractEndDate ? new Date(employee.contractEndDate).toLocaleDateString("es-CO") : "Indefinido" %>',
            totalBonuses: <%= employee.bonuses.replacement + employee.bonuses.others + employee.bonuses.specialty + employee.bonuses.transportation %>
        };

        const csv = Object.keys(employeeData).map(key => 
            `${key},${employeeData[key]}`
        ).join('\n');

        const blob = new Blob([csv], { type: 'text/csv' });
        const url = window.URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = 'empleado_<%= employee.id %>_' + new Date().toISOString().split('T')[0] + '.csv';
        a.click();
        window.URL.revokeObjectURL(url);
    }
</script>
